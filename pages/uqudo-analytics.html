<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="icon" type="image/avif" href="../assets/img/FavIcon.avif">
  <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/FavIcon.avif">
  <title>Uqudo Analytics - Uqudo Admin Portal</title>

  <!-- Authentication & URL Protection -->
  <script>
    if (window.location.pathname.endsWith('.html')) {
      const cleanPath = window.location.pathname.replace('.html', '');
      window.location.replace(cleanPath + window.location.search + window.location.hash);
    }

    (function() {
      const authToken = localStorage.getItem('uqudo_token') || localStorage.getItem('auth_token');
      if (!authToken) {
        window.location.replace('/pages/uqudo-sign-in');
      }
    })();
  </script>

  <!-- Fonts and icons -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700,900" />
  <link href="../assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="../assets/css/nucleo-svg.css" rel="stylesheet" />
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />

  <!-- CSS Files -->
  <link id="pagestyle" href="../assets/css/material-dashboard.css?v=3.2.0" rel="stylesheet" />
  <link href="../assets/css/uqudo-blue-theme.css" rel="stylesheet" />

  <style>
    .session-header-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2rem;
      border-radius: 1rem;
      margin-bottom: 1.5rem;
    }

    .badge-outcome-success { background-color: #4caf50; }
    .badge-outcome-failed { background-color: #f44336; }
    .badge-outcome-abandoned { background-color: #ff9800; }

    .badge-risk-approve { background-color: #4caf50; }
    .badge-risk-review { background-color: #ff9800; }
    .badge-risk-reject { background-color: #f44336; }

    .score-card {
      border-left: 4px solid #667eea;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
    }

    .score-pass { border-left-color: #4caf50; }
    .score-warn { border-left-color: #ff9800; }
    .score-fail { border-left-color: #f44336; }

    .severity-critical { background-color: #f44336; color: white; }
    .severity-high { background-color: #ff9800; color: white; }
    .severity-medium { background-color: #ffc107; color: #000; }

    .timeline-marker {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      display: inline-block;
    }

    .timeline-marker-success { background-color: #4caf50; }
    .timeline-marker-failure { background-color: #f44336; }

    .friction-low { color: #4caf50; }
    .friction-medium { color: #ff9800; }
    .friction-high { color: #f44336; }

    .risk-breakdown-chart {
      height: 200px;
      margin: 1rem 0;
    }

    .copy-button {
      cursor: pointer;
      padding: 0.25rem 0.5rem;
      font-size: 0.75rem;
      border-radius: 0.25rem;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
    }

    .copy-button:hover {
      background: rgba(255,255,255,0.3);
    }

    .device-alert-banner {
      background-color: #fff3cd;
      border-left: 4px solid #ff9800;
      padding: 1rem;
      border-radius: 0.5rem;
      margin-bottom: 1rem;
    }

    .progress-step {
      display: flex;
      align-items: center;
      margin-bottom: 0.5rem;
    }

    .progress-step-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 0.5rem;
      font-size: 12px;
    }

    .progress-step-completed { background-color: #4caf50; color: white; }
    .progress-step-failed { background-color: #f44336; color: white; }
    .progress-step-pending { background-color: #e0e0e0; color: #666; }
  </style>
</head>

<body class="g-sidenav-show bg-gray-200">
  <!-- Sidebar -->
  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-radius-lg fixed-start ms-2 bg-white my-2" id="sidenav-main">
    <div class="sidenav-header" style="height: 112px;">
      <i class="fas fa-times p-3 cursor-pointer text-dark opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
      <a class="navbar-brand m-0 p-0 d-block w-100 h-100 d-flex align-items-center" href="./uqudo-dashboard">
        <img src="../assets/img/uqudo-logo.svg" alt="Uqudo Logo" style="width: 100%; height: auto; display: block;">
      </a>
    </div>
    <hr class="horizontal dark mt-0 mb-2">
    <div class="collapse navbar-collapse w-auto" id="sidenav-collapse-main">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link text-dark" href="./uqudo-dashboard">
            <i class="material-symbols-rounded opacity-10">dashboard</i>
            <span class="nav-link-text ms-1">Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="./accounts">
            <i class="material-symbols-rounded opacity-10">person</i>
            <span class="nav-link-text ms-1">Accounts</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="./alerts">
            <i class="material-symbols-rounded opacity-10">notification_important</i>
            <span class="nav-link-text ms-1">KYC Alerts</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="./cases">
            <i class="material-symbols-rounded opacity-10">gavel</i>
            <span class="nav-link-text ms-1">AML Cases</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active bg-gradient-info text-white" href="./uqudo-analytics">
            <i class="material-symbols-rounded opacity-10">analytics</i>
            <span class="nav-link-text ms-1">Uqudo Analytics</span>
          </a>
        </li>
        <li class="nav-item mt-3">
          <h6 class="ps-4 ms-2 text-uppercase text-xs text-dark font-weight-bolder opacity-8">Configuration</h6>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="./config-kyc">
            <i class="material-symbols-rounded opacity-10">settings</i>
            <span class="nav-link-text ms-1">KYC Setup</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="./config-blocklist">
            <i class="material-symbols-rounded opacity-10">block</i>
            <span class="nav-link-text ms-1">Blocklist</span>
          </a>
        </li>
      </ul>
    </div>
    <div class="sidenav-footer position-absolute w-100 bottom-0">
      <div class="mx-3">
        <a class="btn btn-outline-dark mt-4 w-100" href="documentation" target="_blank">
          <i class="material-symbols-rounded text-sm me-1">description</i>
          Documentation
        </a>
        <a class="btn bg-gradient-info w-100 mt-2" href="#" id="logout-btn">
          <i class="material-symbols-rounded text-sm me-1">logout</i>
          Logout
        </a>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-3 shadow-none border-radius-xl" id="navbarBlur">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="./uqudo-dashboard">Dashboard</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Uqudo Analytics</li>
          </ol>
          <h6 class="font-weight-bolder mb-0">SDK Analytics Dashboard</h6>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group input-group-outline">
              <input type="text" class="form-control" placeholder="Search by JTI or Account ID" id="session-search-input">
            </div>
            <button class="btn btn-sm bg-gradient-info mb-0 ms-2" id="search-session-btn">
              <i class="material-symbols-rounded">search</i>
            </button>
          </div>
          <ul class="navbar-nav justify-content-end">
            <li class="nav-item d-flex align-items-center">
              <a href="#" class="nav-link text-body font-weight-bold px-0">
                <i class="material-symbols-rounded">account_circle</i>
                <span class="d-sm-inline d-none ms-1" id="user-name">User</span>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Analytics Content -->
    <div class="container-fluid py-2">
      <!-- Session Header -->
      <div class="session-header-card" id="session-header" style="display: none;">
        <div class="row">
          <div class="col-md-6">
            <h5 class="text-white mb-3">Session Overview</h5>
            <div class="mb-2">
              <small class="opacity-8">Session ID</small>
              <div class="d-flex align-items-center">
                <span class="me-2" id="session-id-display">-</span>
                <input type="hidden" id="session-id" value="">
                <button class="copy-button" onclick="copyToClipboard('session-id')">
                  <i class="material-symbols-rounded" style="font-size: 14px;">content_copy</i>
                </button>
              </div>
            </div>
            <div class="mb-2">
              <small class="opacity-8">Device ID</small>
              <div class="d-flex align-items-center">
                <span class="me-2" id="device-id-display">-</span>
                <input type="hidden" id="device-id" value="">
                <button class="copy-button" onclick="copyToClipboard('device-id')">
                  <i class="material-symbols-rounded" style="font-size: 14px;">content_copy</i>
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="row g-2">
              <div class="col-6">
                <div class="text-center p-2 bg-white bg-opacity-10 rounded">
                  <small class="opacity-8 d-block">Document Type</small>
                  <span class="badge bg-white text-dark mt-1" id="document-type-badge">-</span>
                </div>
              </div>
              <div class="col-6">
                <div class="text-center p-2 bg-white bg-opacity-10 rounded">
                  <small class="opacity-8 d-block">Outcome</small>
                  <span class="badge mt-1" id="outcome-badge">-</span>
                </div>
              </div>
              <div class="col-6">
                <div class="text-center p-2 bg-white bg-opacity-10 rounded">
                  <small class="opacity-8 d-block">Risk Assessment</small>
                  <span class="badge mt-1" id="risk-badge">-</span>
                </div>
              </div>
              <div class="col-6">
                <div class="text-center p-2 bg-white bg-opacity-10 rounded">
                  <small class="opacity-8 d-block">Duration</small>
                  <span class="mt-1 d-block font-weight-bold" id="duration-display">-</span>
                </div>
              </div>
              <div class="col-6">
                <div class="text-center p-2 bg-white bg-opacity-10 rounded">
                  <small class="opacity-8 d-block">Platform</small>
                  <span class="badge bg-white text-dark mt-1" id="platform-badge">-</span>
                </div>
              </div>
              <div class="col-6">
                <div class="text-center p-2 bg-white bg-opacity-10 rounded">
                  <small class="opacity-8 d-block">Timestamp</small>
                  <span class="mt-1 d-block" style="font-size: 0.75rem;" id="timestamp-display">-</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Sessions List View -->
      <div id="sessions-list-view">
        <!-- Summary Cards -->
        <div class="row mb-4">
          <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
            <div class="card">
              <div class="card-header p-2 ps-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <p class="text-sm mb-0 text-capitalize">Total Sessions</p>
                    <h4 class="mb-0" id="total-sessions-count">
                      <span class="spinner-border spinner-border-sm" role="status"></span>
                    </h4>
                  </div>
                  <div class="icon icon-md icon-shape bg-gradient-info shadow-info shadow text-center border-radius-lg">
                    <i class="material-symbols-rounded opacity-10 text-white">analytics</i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
            <div class="card">
              <div class="card-header p-2 ps-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <p class="text-sm mb-0 text-capitalize">Success Rate</p>
                    <h4 class="mb-0 text-success" id="success-rate">
                      <span class="spinner-border spinner-border-sm" role="status"></span>
                    </h4>
                  </div>
                  <div class="icon icon-md icon-shape bg-gradient-success shadow-success shadow text-center border-radius-lg">
                    <i class="material-symbols-rounded opacity-10 text-white">check_circle</i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-3 col-sm-6 mb-xl-0 mb-4">
            <div class="card">
              <div class="card-header p-2 ps-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <p class="text-sm mb-0 text-capitalize">Avg Duration</p>
                    <h4 class="mb-0" id="avg-duration">
                      <span class="spinner-border spinner-border-sm" role="status"></span>
                    </h4>
                  </div>
                  <div class="icon icon-md icon-shape bg-gradient-info shadow-info shadow text-center border-radius-lg">
                    <i class="material-symbols-rounded opacity-10 text-white">schedule</i>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-xl-3 col-sm-6">
            <div class="card">
              <div class="card-header p-2 ps-3">
                <div class="d-flex justify-content-between">
                  <div>
                    <p class="text-sm mb-0 text-capitalize">Active Now</p>
                    <h4 class="mb-0 text-info" id="active-sessions">
                      <span class="spinner-border spinner-border-sm" role="status"></span>
                    </h4>
                  </div>
                  <div class="icon icon-md icon-shape bg-gradient-warning shadow-warning shadow text-center border-radius-lg">
                    <i class="material-symbols-rounded opacity-10 text-white">play_circle</i>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Analytics Charts -->
        <div class="row mb-4">
          <div class="col-md-6 mb-4">
            <div class="card">
              <div class="card-header pb-0">
                <h6>Verification Status Distribution</h6>
                <p class="text-sm">Bar chart showing status breakdown</p>
              </div>
              <div class="card-body">
                <canvas id="statusBarChart" height="200"></canvas>
              </div>
            </div>
          </div>
          <div class="col-md-6 mb-4">
            <div class="card">
              <div class="card-header pb-0">
                <h6>Session Trends</h6>
                <p class="text-sm">Line chart showing session activity over time</p>
              </div>
              <div class="card-body">
                <canvas id="sessionLineChart" height="200"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Recent Sessions Table -->
        <div class="row">
          <div class="col-12">
            <div class="card">
              <div class="card-header pb-0">
                <div class="d-flex justify-content-between align-items-center">
                  <h6>Recent Sessions</h6>
                  <div>
                    <button class="btn btn-sm btn-outline-info" id="refresh-sessions-btn">
                      <i class="material-symbols-rounded me-1">refresh</i>
                      Refresh
                    </button>
                    <span class="badge bg-success ms-2" id="auto-refresh-indicator">
                      <i class="material-symbols-rounded" style="font-size: 12px;">radio_button_checked</i>
                      Live
                    </span>
                  </div>
                </div>
              </div>
              <div class="card-body px-0 pb-2">
                <div class="table-responsive p-0">
                  <table class="table align-items-center mb-0">
                    <thead>
                      <tr>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Account</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Document</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Status</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Risk</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Duration</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Platform</th>
                        <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Created</th>
                        <th class="text-secondary opacity-7">Actions</th>
                      </tr>
                    </thead>
                    <tbody id="sessions-table-body">
                      <tr>
                        <td colspan="8" class="text-center py-4">
                          <div class="spinner-border text-info" role="status">
                            <span class="visually-hidden">Loading...</span>
                          </div>
                          <p class="text-sm mt-2">Loading sessions...</p>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
              <div class="card-footer">
                <div id="sessions-pagination-container"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Empty State -->
      <div id="empty-state" class="text-center py-5" style="display: none;">
        <i class="material-symbols-rounded" style="font-size: 64px; color: #667eea;">analytics</i>
        <h4 class="mt-3">No sessions found</h4>
        <p class="text-muted">Sessions will appear here as they are created</p>
      </div>

      <!-- Tabs Container -->
      <div id="tabs-container" style="display: none;">
        <!-- Nav Tabs -->
        <ul class="nav nav-tabs mb-4" id="analyticsTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="verification-tab" data-bs-toggle="tab" data-bs-target="#verification" type="button" role="tab">
              <i class="material-symbols-rounded me-1">verified</i>
              Verification Summary
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="fraud-tab" data-bs-toggle="tab" data-bs-target="#fraud" type="button" role="tab">
              <i class="material-symbols-rounded me-1">warning</i>
              Journey Fraud Flags
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="device-tab" data-bs-toggle="tab" data-bs-target="#device" type="button" role="tab">
              <i class="material-symbols-rounded me-1">devices</i>
              Device History
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="ux-tab" data-bs-toggle="tab" data-bs-target="#ux" type="button" role="tab">
              <i class="material-symbols-rounded me-1">trending_up</i>
              UX Analysis
            </button>
          </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="analyticsTabContent">
          <!-- Tab 1: Verification Summary -->
          <div class="tab-pane fade show active" id="verification" role="tabpanel">
            <div class="row">
              <div class="col-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Document Verification</h6>
                  </div>
                  <div class="card-body" id="document-verification-panel">
                    <p class="text-muted">Loading verification data...</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Biometric Verification</h6>
                  </div>
                  <div class="card-body" id="biometric-panel">
                    <p class="text-muted">Loading biometric data...</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card" id="chip-reading-card" style="display: none;">
                  <div class="card-header pb-0">
                    <h6>Chip Reading (NFC)</h6>
                  </div>
                  <div class="card-body" id="chip-reading-panel">
                    <p class="text-muted">Loading chip data...</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tab 2: Journey Fraud Flags -->
          <div class="tab-pane fade" id="fraud" role="tabpanel">
            <div class="row mb-4">
              <div class="col-md-4">
                <div class="card text-center" id="critical-card">
                  <div class="card-body">
                    <h2 class="mb-0" id="critical-count">0</h2>
                    <p class="text-sm mb-0">Critical Flags</p>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card text-center" id="high-card">
                  <div class="card-body">
                    <h2 class="mb-0" id="high-count">0</h2>
                    <p class="text-sm mb-0">High Flags</p>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="card text-center" id="medium-card">
                  <div class="card-body">
                    <h2 class="mb-0" id="medium-count">0</h2>
                    <p class="text-sm mb-0">Medium Flags</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Fraud Flags Summary</h6>
                  </div>
                  <div class="card-body">
                    <div class="table-responsive">
                      <table class="table align-items-center mb-0">
                        <thead>
                          <tr>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Flag Type</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Count</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Severity</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Timestamps</th>
                          </tr>
                        </thead>
                        <tbody id="fraud-flags-table">
                          <tr>
                            <td colspan="4" class="text-center">No fraud flags detected</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Risk Score Breakdown</h6>
                  </div>
                  <div class="card-body">
                    <div id="risk-breakdown-chart" class="risk-breakdown-chart"></div>
                    <div class="row mt-3">
                      <div class="col-md-4 text-center">
                        <h6 class="mb-0" id="verification-risk-score">0</h6>
                        <small class="text-muted">Verification Risk</small>
                      </div>
                      <div class="col-md-4 text-center">
                        <h6 class="mb-0" id="journey-risk-score">0</h6>
                        <small class="text-muted">Journey Risk</small>
                      </div>
                      <div class="col-md-4 text-center">
                        <h6 class="mb-0" id="device-risk-score">0</h6>
                        <small class="text-muted">Device Risk</small>
                      </div>
                    </div>
                    <div class="text-center mt-3">
                      <h4 class="mb-0">Total Risk Score: <span id="total-risk-score" class="text-info">0</span></h4>
                      <span class="badge badge-lg mt-2" id="risk-level-badge">LOW</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tab 3: Device History -->
          <div class="tab-pane fade" id="device" role="tabpanel">
            <div id="device-alert" class="device-alert-banner" style="display: none;">
              <i class="material-symbols-rounded me-2">warning</i>
              <strong id="device-alert-text">Device alert information</strong>
            </div>

            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Device Profile</h6>
                  </div>
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Device ID</small>
                        <p class="mb-0 font-weight-bold" id="device-profile-id">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">First Seen</small>
                        <p class="mb-0 font-weight-bold" id="device-first-seen">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Total Sessions</small>
                        <p class="mb-0 font-weight-bold" id="device-total-sessions">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Success Rate</small>
                        <p class="mb-0 font-weight-bold" id="device-success-rate">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Successful</small>
                        <p class="mb-0 text-success" id="device-successful">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Failed</small>
                        <p class="mb-0 text-danger" id="device-failed">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Abandoned</small>
                        <p class="mb-0 text-warning" id="device-abandoned">-</p>
                      </div>
                      <div class="col-md-3 mb-3">
                        <small class="text-muted">Total Fraud Flags</small>
                        <p class="mb-0 font-weight-bold" id="device-fraud-flags">-</p>
                      </div>
                    </div>
                    <div class="mt-3">
                      <small class="text-muted">Document Types Used</small>
                      <div id="device-document-types" class="mt-1">-</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Previous Sessions</h6>
                  </div>
                  <div class="card-body">
                    <div class="table-responsive">
                      <table class="table align-items-center mb-0">
                        <thead>
                          <tr>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Date</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Outcome</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Duration</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Fraud Flags</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Document Type</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Failure Reason</th>
                          </tr>
                        </thead>
                        <tbody id="device-sessions-table">
                          <tr>
                            <td colspan="6" class="text-center">No previous sessions found</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Tab 4: UX Analysis -->
          <div class="tab-pane fade" id="ux" role="tabpanel">
            <div class="row">
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Session Flow Metrics</h6>
                  </div>
                  <div class="card-body" id="session-flow-metrics">
                    <p class="text-muted">Loading flow metrics...</p>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Conversion Funnel</h6>
                  </div>
                  <div class="card-body" id="conversion-funnel">
                    <p class="text-muted">Loading funnel...</p>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Friction Analysis</h6>
                  </div>
                  <div class="card-body">
                    <div class="table-responsive">
                      <table class="table align-items-center mb-0">
                        <thead>
                          <tr>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Step</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Score</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Level</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Issues</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Duration</th>
                            <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Attempts</th>
                          </tr>
                        </thead>
                        <tbody id="friction-analysis-table">
                          <tr>
                            <td colspan="6" class="text-center">No friction data available</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-12">
                <div class="card">
                  <div class="card-header pb-0">
                    <h6>Environment Issues</h6>
                  </div>
                  <div class="card-body">
                    <div class="row" id="environment-issues">
                      <p class="text-muted">Loading environment issues...</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer py-4 mt-4">
      <div class="container-fluid">
        <div class="row align-items-center justify-content-lg-between">
          <div class="col-lg-6 mb-lg-0 mb-4">
            <div class="copyright text-center text-sm text-muted text-lg-start">
              Â© <script>document.write(new Date().getFullYear())</script> Uqudo Admin Portal
            </div>
          </div>
        </div>
      </div>
    </footer>
  </main>

  <!-- Session Detail Modal with Radar Chart -->
  <div class="modal fade" id="sessionDetailModal" tabindex="-1" aria-labelledby="sessionDetailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header bg-gradient-info">
          <h5 class="modal-title text-white" id="sessionDetailModalLabel">Session Verification Details</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <!-- Radar Chart -->
            <div class="col-md-6">
              <h6 class="mb-3">Verification Scores</h6>
              <canvas id="verificationRadarChart" height="300"></canvas>
            </div>
            <!-- Session Data Table -->
            <div class="col-md-6">
              <h6 class="mb-3">Session Information</h6>
              <div class="table-responsive">
                <table class="table table-sm align-items-center mb-0">
                  <tbody id="modal-session-data">
                    <tr>
                      <td class="text-sm font-weight-bold">Session ID</td>
                      <td class="text-sm" id="modal-session-id">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Account Name</td>
                      <td class="text-sm" id="modal-account-name">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Email</td>
                      <td class="text-sm" id="modal-email">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Document Type</td>
                      <td class="text-sm" id="modal-doc-type">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Verification Status</td>
                      <td class="text-sm" id="modal-status">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Platform</td>
                      <td class="text-sm" id="modal-platform">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Duration</td>
                      <td class="text-sm" id="modal-duration">-</td>
                    </tr>
                    <tr>
                      <td class="text-sm font-weight-bold">Created At</td>
                      <td class="text-sm" id="modal-created">-</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="mt-4">
                <h6 class="mb-3">Verification Details</h6>
                <div id="modal-verification-details"></div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-info" onclick="viewFullSessionDetail()">View Full Details</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Core JS Files -->
  <script src="../assets/js/core/popper.min.js"></script>
  <script src="../assets/js/core/bootstrap.min.js"></script>
  <script src="../assets/js/plugins/perfect-scrollbar.min.js"></script>
  <script src="../assets/js/plugins/smooth-scrollbar.min.js"></script>
  <script src="../assets/js/material-dashboard.min.js?v=3.2.0"></script>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <!-- API Client & Utils -->
  <script src="../assets/js/api-client.js"></script>
  <script src="../assets/js/utils.js"></script>

  <!-- Analytics Script -->
  <script src="../assets/js/uqudo-analytics.js"></script>

  <!-- Vercel Analytics -->
  <script type="module">
    import { inject } from 'https://cdn.jsdelivr.net/npm/@vercel/analytics@1.6.1/+esm';
    inject();
  </script>
</body>

</html>
